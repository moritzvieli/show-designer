<div class="modal-header">
  <h4 class="modal-title pull-left">{{ 'fixture-pool.title' | translate }}</h4>
  <button type="button" class="close pull-right" aria-label="Close" (click)="bsModalRef.hide()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body">
  <div class="row">
    <div class="col-6">
      <!-- Create a new template -->
      <a class="btn btn-primary mb-3 btn btn-primary btn-block" href="#" role="button" (click)="createSet(); false">
        <i class="fa fa-plus" aria-hidden="true"></i> {{ 'fixture-pool.create-template' | translate }}
      </a>

      <!-- Search for template -->
      <input type="text" class="form-control input-block mb-3" id="searchSet"
        placeholder="{{ 'fixture-pool.search-templates' | translate }}" (input)="filterTemplates($event.target.value)">

      <!-- Templates -->
      <div class="card border-secondary" style="height: 200px;">
        <div class="card-body p-0">
          <div class="list-group list-group-flush">
            <a *ngIf="loadingTemplates"
              class="list-group-item list-group-item-action flex-column align-items-start d-flex">
              <p class="mb-0 mx-auto">
                <i class="fa fa-spinner fa-pulse fa-fw"></i>
              </p>
            </a>

            <div class="list-group-item" *ngFor="let template of filteredTemplates">
              <div class="row">
                <div class="col-10 col-auto my-auto">
                  <p class="mb-0">{{ template.manufacturerName }} - {{ template.name }}</p>
                </div>
                <div class="col-2 my-auto">
                  <a class="btn btn-primary btn-sm float-right" href="#" role="button"
                    (click)="addFixture(template); false">
                    <i class="fa fa-plus" aria-hidden="true"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-6">
      <!-- Fixtures -->
      <div class="form-group row">
        <label class="col-lg-2 col-form-label">{{ 'fixture-pool.universe' | translate }}</label>
        <select class="custom-select">
          <option>Universe 1</option>
        </select>
      </div>
      <div class="card border-secondary" style="height: 300px;">
        <div class="card-body p-0">
          <div class="list-group list-group-flush" [sortablejs]="fixtureService.fixtures">
            <div class="list-group-item" *ngFor="let fixture of fixtureService.fixtures"
              [class.active]="fixture == selectedFixture" (click)="selectedFixture = fixture" style="cursor: pointer;">
              <div class="row">
                <div class="col-auto list-sort-handle my-auto" style="cursor: move; cursor: -webkit-grabbing;">
                  <i class="fa fa-bars" aria-hidden="true"></i>
                </div>
                <div class="col-auto flex-grow pl-0 my-auto">
                  <p class="mb-0">{{ fixture.name }}</p>
                </div>
                <div class="col-auto my-auto">
                  <a class="btn btn-primary btn-sm float-right" href="#" role="button"
                    (click)="removeFixture(fixture); false">
                    <i class="fa fa-minus" aria-hidden="true"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col">
      <!-- Tab navigation -->
      <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="sets-tab" data-toggle="tab" href="#dmx" role="tab">
            <i class="icon-ola" aria-hidden="true"></i> {{ 'fixture-pool.dmx' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="compositions-tab" data-toggle="tab" href="#settings" role="tab">
            <i class="fa fa-cog" aria-hidden="true"></i> {{ 'fixture-pool.settings' | translate }}
          </a>
        </li>
      </ul>

      <!-- Tab content -->
      <div class="tab-content" id="myTabContent">
        <!-- DMX universe overview-->
        <div class="tab-pane show active" id="dmx" role="tabpanel">
          <div class="form-group row">
            <div class="col-auto flex-grow"></div>
            <div class="col-lg-3 d-flex">
              <div class="form-check my-auto ml-auto">
                <input type="checkbox" class="form-check-input" id="showChannelNumbers" [ngModel]="showChannelNumbers"
                  (ngModelChange)="showChannelNumbers = $event">
                <label class="form-check-label" for="showChannelNumbers">Show channels</label>
              </div>
            </div>
          </div>

          <div>
            <div *ngFor="let channel of dmxChannels; let i = index;" class="dmx-channel"
              [class.dmx-channel-occupied]="channelOccupied(i)"
              [class.dmx-channel-occupied-start]="channelOccupiedStart(i)"
              [class.dmx-channel-occupied-end]="channelOccupiedEnd(i)"
              [class.dmx-channel-overlapped]="channelOverlapped(i)" (mousedown)="channelMouseDown($event)"
              (mouseover)="channelMouseOver($event)" [attr.data-index]="i">
              <div class="d-flex w-100 dmx-channel-text" [attr.data-index]="i"
                [class.dmx-channel-text-visible]="showChannelNumbers">
                <div class="m-auto" style="font-size: 11px" [attr.data-index]="i"><small
                    [attr.data-index]="i">{{ (i + 1) }}</small>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Fixture settings -->
        <div class="tab-pane" id="settings" role="tabpanel">
          <div *ngIf="selectedFixture && fixtureService.getTemplateByFixture(selectedFixture)">

            <div class="form-group row">
              <label class="col-lg-3 col-form-label"
                for="fixtureName">{{ 'fixture-pool.fixture-name' | translate }}</label>
              <div class="col-lg-9 d-flex">
                <input type="text" class="form-control" [(ngModel)]="selectedFixture.name" maxlength="200"
                  id="fixtureName">
              </div>
            </div>

            <div class="form-group row">
              <label class="col-lg-3 col-form-label">{{ 'fixture-pool.mode' | translate }}</label>
              <div class="col-lg-9 d-flex">
                <select class="custom-select" [ngModel]="selectedFixture.modeShortName"
                  (ngModelChange)="selectedFixture.modeShortName = $event">
                  <option *ngFor="let mode of fixtureService.getTemplateByFixture(selectedFixture).modes"
                    [ngValue]="mode.shortName">
                    {{ mode.name }} - {{ mode.channels.length }} {{ 'fixture-pool.channels' | translate }}</option>
                </select>
              </div>
            </div>

          </div>
        </div>
      </div>

    </div>
  </div>
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-default" (click)="ok()">{{ 'misc.ok' | translate }}</button>
</div>